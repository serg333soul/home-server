name: CI/CD Pipeline

on:
  push:
    branches: [ "main" ]
  workflow_dispatch:

jobs:
  test-scripts:
    name: üõ°Ô∏è Security & Syntax Check
    runs-on: ubuntu-latest
    steps:
      - name: Checkout Code
        uses: actions/checkout@v4

      - name: Run ShellCheck
        uses: ludeeus/action-shellcheck@master
        with:
          scandir: './scripts'

  deploy:
    name: üöÄ Deploy to Home Server
    needs: test-scripts
    runs-on: self-hosted
    
    steps:
      - name: Checkout Code
        uses: actions/checkout@v4

      - name: Update Scripts
        run: |
          echo "üì• –û—Ç—Ä–∏–º—É—î–º–æ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è..."
          cp -rv scripts/* /home/ruban/nextcloud/scripts/
          chmod +x /home/ruban/nextcloud/scripts/*.sh
          echo "‚úÖ –°–∫—Ä–∏–ø—Ç–∏ –æ–Ω–æ–≤–ª–µ–Ω–æ —É—Å–ø—ñ—à–Ω–æ!"
